{
  "type": "record",
  "name": "CommerceEvent",
  "namespace": "com.acme.platform",
  "doc": "Universal commerce event. One schema to rule them all. Every field is nullable because different event types populate different subsets. The 'entity_type' + 'action' fields tell you what's populated.",
  "fields": [
    {"name": "event_id", "type": "string"},
    {"name": "timestamp", "type": "long"},
    {"name": "entity_type", "type": "string", "doc": "One of: customer, order, product, review, cart, wishlist"},
    {"name": "action", "type": "string", "doc": "One of: created, updated, deleted, restored"},
    {"name": "tenant_id", "type": "string"},
    {"name": "user_id", "type": ["null", "string"], "default": null, "doc": "The actor who triggered this change, if known."},

    {"name": "customer_id", "type": ["null", "string"], "default": null},
    {"name": "customer_email", "type": ["null", "string"], "default": null},
    {"name": "customer_name", "type": ["null", "string"], "default": null},
    {"name": "customer_phone", "type": ["null", "string"], "default": null},
    {"name": "customer_tier", "type": ["null", "string"], "default": null, "doc": "bronze/silver/gold/platinum"},
    {"name": "customer_is_active", "type": ["null", "boolean"], "default": null},
    {"name": "customer_created_at", "type": ["null", "long"], "default": null},
    {"name": "customer_marketing_opt_in", "type": ["null", "boolean"], "default": null},

    {"name": "order_id", "type": ["null", "string"], "default": null},
    {"name": "order_customer_id", "type": ["null", "string"], "default": null},
    {"name": "order_status", "type": ["null", "string"], "default": null, "doc": "pending/confirmed/shipped/delivered/cancelled/returned"},
    {"name": "order_total_cents", "type": ["null", "long"], "default": null},
    {"name": "order_currency", "type": ["null", "string"], "default": null},
    {"name": "order_item_count", "type": ["null", "int"], "default": null},
    {"name": "order_shipping_method", "type": ["null", "string"], "default": null},
    {"name": "order_shipping_address_line1", "type": ["null", "string"], "default": null},
    {"name": "order_shipping_address_line2", "type": ["null", "string"], "default": null},
    {"name": "order_shipping_address_city", "type": ["null", "string"], "default": null},
    {"name": "order_shipping_address_state", "type": ["null", "string"], "default": null},
    {"name": "order_shipping_address_zip", "type": ["null", "string"], "default": null},
    {"name": "order_shipping_address_country", "type": ["null", "string"], "default": null},
    {"name": "order_placed_at", "type": ["null", "long"], "default": null},
    {"name": "order_cancelled_at", "type": ["null", "long"], "default": null},
    {"name": "order_cancelled_reason", "type": ["null", "string"], "default": null},

    {"name": "product_id", "type": ["null", "string"], "default": null},
    {"name": "product_name", "type": ["null", "string"], "default": null},
    {"name": "product_description", "type": ["null", "string"], "default": null},
    {"name": "product_sku", "type": ["null", "string"], "default": null},
    {"name": "product_price_cents", "type": ["null", "long"], "default": null},
    {"name": "product_currency", "type": ["null", "string"], "default": null},
    {"name": "product_category", "type": ["null", "string"], "default": null},
    {"name": "product_subcategory", "type": ["null", "string"], "default": null},
    {"name": "product_brand", "type": ["null", "string"], "default": null},
    {"name": "product_is_active", "type": ["null", "boolean"], "default": null},
    {"name": "product_weight_grams", "type": ["null", "int"], "default": null},
    {"name": "product_tags", "type": ["null", "string"], "default": null, "doc": "Comma-separated tag list."},

    {"name": "review_id", "type": ["null", "string"], "default": null},
    {"name": "review_product_id", "type": ["null", "string"], "default": null},
    {"name": "review_customer_id", "type": ["null", "string"], "default": null},
    {"name": "review_rating", "type": ["null", "int"], "default": null, "doc": "1-5"},
    {"name": "review_title", "type": ["null", "string"], "default": null},
    {"name": "review_body", "type": ["null", "string"], "default": null},
    {"name": "review_is_verified_purchase", "type": ["null", "boolean"], "default": null},
    {"name": "review_submitted_at", "type": ["null", "long"], "default": null},
    {"name": "review_moderation_status", "type": ["null", "string"], "default": null, "doc": "pending/approved/rejected"},

    {"name": "cart_id", "type": ["null", "string"], "default": null},
    {"name": "cart_customer_id", "type": ["null", "string"], "default": null},
    {"name": "cart_item_count", "type": ["null", "int"], "default": null},
    {"name": "cart_total_cents", "type": ["null", "long"], "default": null},
    {"name": "cart_last_activity_at", "type": ["null", "long"], "default": null},
    {"name": "cart_items_json", "type": ["null", "string"], "default": null, "doc": "JSON blob of cart line items because we ran out of ideas."},

    {"name": "wishlist_id", "type": ["null", "string"], "default": null},
    {"name": "wishlist_customer_id", "type": ["null", "string"], "default": null},
    {"name": "wishlist_name", "type": ["null", "string"], "default": null},
    {"name": "wishlist_item_count", "type": ["null", "int"], "default": null},
    {"name": "wishlist_is_public", "type": ["null", "boolean"], "default": null},
    {"name": "wishlist_product_ids_json", "type": ["null", "string"], "default": null, "doc": "JSON array of product IDs. Yeah, we know."},

    {"name": "extra_json", "type": ["null", "string"], "default": null, "doc": "Overflow field for anything that doesn't fit above."}
  ]
}
