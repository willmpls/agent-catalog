{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://acme.com/schemas/iot-telemetry/v1",
  "title": "IoTTelemetryEvent",
  "description": "High-frequency sensor readings from IoT devices. Not a traditional CRUD entity â€” this is append-only telemetry. The challenge is mapping this to the event contract standard when there's no 'entity state' to snapshot.",
  "type": "object",
  "required": ["event_id", "device_id", "timestamp", "readings"],
  "properties": {
    "event_id": {
      "type": "string",
      "format": "uuid"
    },
    "device_id": {
      "type": "string",
      "description": "Stable device identifier."
    },
    "device_type": {
      "type": "string",
      "enum": ["temperature_sensor", "humidity_sensor", "pressure_sensor", "multi_sensor", "gateway"]
    },
    "firmware_version": {
      "type": "string"
    },
    "timestamp": {
      "type": "integer",
      "description": "Unix epoch seconds when the reading was taken."
    },
    "location": {
      "type": ["object", "null"],
      "properties": {
        "latitude": { "type": "number" },
        "longitude": { "type": "number" },
        "altitude_meters": { "type": ["number", "null"] },
        "accuracy_meters": { "type": ["number", "null"] }
      },
      "required": ["latitude", "longitude"]
    },
    "readings": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["metric", "value"],
        "properties": {
          "metric": {
            "type": "string",
            "description": "Metric name, e.g. 'temperature_celsius', 'humidity_pct', 'battery_pct'."
          },
          "value": {
            "type": "number",
            "description": "The reading value."
          },
          "unit": {
            "type": "string",
            "description": "Unit of measure, e.g. 'celsius', 'percent', 'hPa'."
          },
          "quality": {
            "type": "string",
            "enum": ["good", "degraded", "fault"],
            "default": "good"
          }
        }
      }
    },
    "alerts": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["alert_type", "severity", "message"],
        "properties": {
          "alert_type": {
            "type": "string",
            "enum": ["threshold_breach", "anomaly", "device_offline", "low_battery"]
          },
          "severity": {
            "type": "string",
            "enum": ["info", "warning", "critical"]
          },
          "message": { "type": "string" },
          "metric": { "type": ["string", "null"] },
          "threshold_value": { "type": ["number", "null"] },
          "actual_value": { "type": ["number", "null"] }
        }
      },
      "default": []
    },
    "tags": {
      "type": "object",
      "additionalProperties": { "type": "string" },
      "description": "Arbitrary device/deployment labels.",
      "default": {}
    }
  }
}
